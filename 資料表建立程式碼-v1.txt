-- 建立 Person 表，儲存人員資訊
CREATE TABLE Person (
    PersonID INT NOT NULL PRIMARY KEY IDENTITY(1,1),
    DetectionID INT NOT NULL  -- 外部檢測系統的ID
);

-- 建立 Location 表，儲存監控地點資訊
CREATE TABLE Location (
    LocationID INT NOT NULL PRIMARY KEY IDENTITY(1,1),
    LocationName VARCHAR(100) NOT NULL,  -- 地點名稱
    Area FLOAT NOT NULL                  -- 地點面積（平方公尺）
);

-- 建立 StayRecord 表，記錄人員在地點的停留資訊
CREATE TABLE StayRecord (
    StayRecordID INT NOT NULL PRIMARY KEY IDENTITY(1,1),
    PersonID INT NOT NULL FOREIGN KEY REFERENCES Person(PersonID),
    LocationID INT NOT NULL FOREIGN KEY REFERENCES Location(LocationID),
    ArrivalTime DATETIME NOT NULL,     -- 進入地點的時間
    DepartureTime DATETIME NULL,       -- 離開地點的時間（允許為空，表示尚未離開）
    Duration FLOAT NULL                -- 停留時長（分鐘），可在DepartureTime確定後計算
);

-- 建立 TrafficStats 表，統計特定時間段內的人流數據
CREATE TABLE TrafficStats (
    StatsID INT NOT NULL PRIMARY KEY IDENTITY(1,1),
    LocationID INT NOT NULL FOREIGN KEY REFERENCES Location(LocationID),
    StartTime DATETIME NOT NULL,        -- 統計時間段的開始時間
    EndTime DATETIME NOT NULL,          -- 統計時間段的結束時間
    PersonCount INT NOT NULL,           -- 人數統計
    AverageDuration FLOAT NULL,         -- 平均停留時間（分鐘）
    OccupancyRate FLOAT NULL            -- 佔用率（百分比）
);

-- 建立 CongestionRecord 表，記錄壅塞狀況
CREATE TABLE CongestionRecord (
    CongestionID INT NOT NULL PRIMARY KEY IDENTITY(1,1),
    LocationID INT NOT NULL FOREIGN KEY REFERENCES Location(LocationID),
    StartTime DATETIME NOT NULL,   -- 壅塞開始時間
    EndTime DATETIME NOT NULL,     -- 壅塞結束時間
    AverageOccupancyRate FLOAT NOT NULL   -- 壅塞期間的平均佔用率（百分比）
);

-- 建立 ComfortRecord 表，記錄舒適度狀況
CREATE TABLE ComfortRecord (
    ComfortID INT NOT NULL PRIMARY KEY IDENTITY(1,1),
    LocationID INT NOT NULL FOREIGN KEY REFERENCES Location(LocationID),
    StartTime DATETIME NOT NULL,   -- 舒適狀態開始時間
    EndTime DATETIME NOT NULL,     -- 舒適狀態結束時間
    AverageOccupancyRate FLOAT NOT NULL   -- 舒適期間的平均佔用率（百分比）
);
